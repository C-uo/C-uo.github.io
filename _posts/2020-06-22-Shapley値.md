---
title: Shapley値
categories: Programming
date: 2020-06-22 15:27:58 +0900
tags:

mathjax: true
---

>   Shapley値はゲーム理論において協力によって得られた利得を各プレイヤーへ公正に分配する方法の一つの案である。

<!--more-->

## Shapley値公式
$$ \phi_i(v) = \sum_{S \subseteq N \\ \lbrace i \rbrace} \frac{|S|!( |N| - |S| - 1 )!}{|N|!}({v ( S \small \bigcup \lbrace i \rbrace )} - v(S))$$



## 例で説明するShapley値の計算法

張さん、王さん、李さんはテスト勉強しています。

$ N = \lbrace 張さん、王さん、李さん \rbrace $



独学の場合は

張さんは40点を取れます。	$v(張) = 40$

王さんは60点を取れます。	$v(王) = 60$

李さんは90点を取れます。	$v(李) = 90$



張さんと王さんに勉強会をすると合計140点を取れます。	$v(張, 王) = 140$

張さんと李さんに勉強会をすると合計150点を取れます。	$v(張, 李) = 160$

王さんと李さんに勉強会をすると合計175点を取れます。	$v(王, 李) = 175$



3人一緒に勉強すると合計240点を取れます。	$v(張、王、李) = 240$

### それぞれの貢献度を求める

$$i = 張さん$$

$$S \subset \lbrace \emptyset, (王さん), (李さん), (王さん, 李さん)\rbrace$$



$S = \emptyset$の場合

$$\frac{1}{3}(v(張) - v(\emptyset)) = \frac{40}{3}$$



$S = (王さん)$の場合

$$\frac{1}{6}(v(張, 王) - v(王)) = \frac{1}{6}(160 - 60) = \frac{50}{3}$$



$S = (李さん)$の場合

$$\frac{1}{6}(v(張，李) - v(李)) = \frac{1}{6}(160 - 90) = \frac{35}{3}$$



$S = (王さん, 李さん)$の場合

$$\frac{1}{3}(v(張，王，李) - v(王, 李)) = \frac{1}{3}(240 - 175) = \frac{65}{3}$$



よって、

$$ \phi_張(v) =  \frac{190}{3}$$

$i = 王さん, i = 李さん$のときも同じような計算すると

$$ \phi_王(v) = 95$$

$$ \phi_李(v) = \frac{245}{3}$$

